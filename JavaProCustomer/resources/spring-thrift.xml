<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:p="http://www.springframework.org/schema/p"
	xmlns:mvc="http://www.springframework.org/schema/mvc" 
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:util="http://www.springframework.org/schema/util"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd    
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd    
            http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd  
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd            http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd"
>

	<!-- thrift 连接池 -->
	<bean id="thriftConnectionPool" class="com.java.core.rpc.thrift.supports.ThriftConnectionPool">
		<property name="host" value="127.0.0.1"/>
		<property name="port" value="29999"/>
		<property name="maxConnections" value="35"/>
		<property name="minConnections" value="20"/>
		<property name="waitTimeout" value="300" />

		<!--保活时间  超过15秒 回收 maxConnection -->
		<property name="keepAlive" value="15"/>
		<property name="protocolTypeClass" value="org.apache.thrift.protocol.TCompactProtocol"/>

	</bean>


	<!-- 服务管理类 -->
	<bean id="thriftServiceManager" class="com.java.core.rpc.thrift.supports.ThriftServiceManager" >
		<property name="thriftConnectionPool" ref="thriftConnectionPool"></property>


	</bean>
	
	<!-- 通过实现 FactoryBean ，在进行动态代理，实现对服务的配置-->
	<bean id="thriftTestService" class="com.java.core.rpc.thrift.supports.ThriftSpringFactoryBean">
		<property name="thriftServiceManager" ref="thriftServiceManager" ></property>
		<property name="serviceIfaceClass" value="com.java.core.rpc.thrift.service.IThriftTestService.Iface" ></property>

	</bean>


	<bean id="thriftInfoTestService" class="com.java.core.rpc.thrift.supports.ThriftSpringFactoryBean">
		<property name="thriftServiceManager" ref="thriftServiceManager" ></property>
		<property name="serviceIfaceClass" value="com.java.core.rpc.thrift.service.IThriftInfoTestService.Iface" ></property>

	</bean>
    
</beans>
	